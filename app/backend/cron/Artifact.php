<?php
namespace backend\cron;

use \backend\DbFactory;
use backend\artifact\model\ArtifactModel;
use backend\tag\model\TagModel;

class Artifact
{
    private static $arrSocketAutotagize = array(
        'address' => '127.0.0.1', 
        'port' => 44532, 
        'socket' => null
    );
    
    public function fillSearchIndexes () {
        $objArtifactModel = new ArtifactModel();
        $objArtifactModel->fillSearchIndexes();
    }
    
    public function goAutotagize ($numLimit = 1) {
        $numThisMethodSocketPort = 44856;
        
        if (@fsockopen(self::$arrSocketAutotagize['address'], $numThisMethodSocketPort)) {
            exit( 'Another  is running, dying' );
        }

        if (( self::$arrSocketAutotagize['socket'] = socket_create(AF_INET, SOCK_STREAM, SOL_TCP)) === false) {
            exit("socket_create() failed: reason: ".socket_strerror(socket_last_error())."\n");
        }

        if (socket_bind(self::$arrSocketAutotagize['socket'], self::$arrSocketAutotagize['address'], $numThisMethodSocketPort) === false) {
            exit("socket_bind() failed: reason: ".socket_strerror(socket_last_error(self::$arrSocketAutotagize['socket']))."\n");
        }

        if (socket_listen(self::$arrSocketAutotagize['socket'], 1) === false) {
            exit("socket_listen() failed: reason: ".socket_strerror(socket_last_error(self::$arrSocketAutotagize['socket']))."\n");
        }
        
        $numTimeStart = time();
        
        $objArtifactModel = new ArtifactModel();
        $arrDataToTagize = $objArtifactModel->getDataToCronAutotagize($numLimit);
        $numRowsDone = 0;
        if (!empty($arrDataToTagize)) {
            $objTagModel = new TagModel();
            $arrRestrictedTags = $objTagModel->getLastRemoved();
            foreach ($arrDataToTagize as $arrRowToTagize) {
                $arrTags = $objTagModel->extractTagsFromString($arrRowToTagize['titles_concated']);
                if (!empty($arrTags)) {
                    $objArtifactModel->addTags($arrRowToTagize['item_id'], $arrTags, $arrRestrictedTags);
                    $numRowsDone++;
                }
            }
            echo sprintf('Done %d artifacts in %s s. %s', $numRowsDone, (time()-$numTimeStart), PHP_EOL);
        } else {
            echo 'NOTHING ELSE TO DO :)'.PHP_EOL;
        }
        
        socket_close(self::$arrSocketAutotagize['socket']);
        self::$arrSocketAutotagize['socket'] = null;
    }
    
    public static function genreAdultsQuery ($strConnectionName) {
        $arrReservedWords = array();
        $arrReservedWords[] = 'seks';
        $arrReservedWords[] = 'sex';
        $arrReservedWords[] = 'sexi';
        $arrReservedWords[] = 'seksi';
        $arrReservedWords[] = 'majtki';
        $arrReservedWords[] = 'figi';
        $arrReservedWords[] = 'bokserki';
        $arrReservedWords[] = 'stringi';
        $arrReservedWords[] = 'lateks';
        $arrReservedWords[] = 'biustonosz';
        $arrReservedWords[] = 'gorset';
        $arrReservedWords[] = 'ponczochy';
        $arrReservedWords[] = 'rajstopy';
        $arrReservedWords[] = 'stanik';
        $arrReservedWords[] = 'kamasutra';
        $arrReservedWords[] = 'porno';
        $arrReservedWords[] = 'wibrator';
        $arrReservedWords[] = 'prezerwatywa';
        $arrReservedWords[] = 'kondom';
        $arrReservedWords[] = 'zakolanowki';
        $arrReservedWords[] = 'podwiazka';
        $arrReservedWords[] = 'halka';
        $arrReservedWords[] = 'bielizna';
        $arrReservedWords[] = 'stroj';
        $arrReservedWords[] = 'stroj kapielowy';
        $arrReservedWords[] = 'kostium';
        $arrReservedWords[] = 'kostium kapielowy';
        $arrReservedWords[] = 'body';
        $arrReservedWords[] = 'triumph';
        $arrReservedWords[] = 'slipy';
        $arrReservedWords[] = 'kapielowki';
        $arrReservedWords[] = 'kabaretki';
        
        $arrReservedWords[] = 'chój';
        $arrReservedWords[] = 'chója';
        $arrReservedWords[] = 'chójek';
        $arrReservedWords[] = 'chóju';
        $arrReservedWords[] = 'chójem';
        $arrReservedWords[] = 'chójnia';
        $arrReservedWords[] = 'chójowy';
        $arrReservedWords[] = 'chójowa';
        $arrReservedWords[] = 'chójowe';
        $arrReservedWords[] = '2chuj';
        $arrReservedWords[] = 'chuja';
        $arrReservedWords[] = 'chujek';
        $arrReservedWords[] = 'chuju';
        $arrReservedWords[] = 'chujem';
        $arrReservedWords[] = 'chujnia';
        $arrReservedWords[] = 'chujowy';
        $arrReservedWords[] = 'chujowa';
        $arrReservedWords[] = 'chujowe';
        $arrReservedWords[] = 'cipa';
        $arrReservedWords[] = 'cipę';
        $arrReservedWords[] = 'cipe';
        $arrReservedWords[] = 'cipą';
        $arrReservedWords[] = 'cipie';
        $arrReservedWords[] = 'dojebać';
        $arrReservedWords[] = 'dojebac';
        $arrReservedWords[] = 'dojebie';
        $arrReservedWords[] = 'dojebał';
        $arrReservedWords[] = 'dojebal';
        $arrReservedWords[] = 'dojebała';
        $arrReservedWords[] = 'dojebala';
        $arrReservedWords[] = 'dojebałem';
        $arrReservedWords[] = 'dojebalem';
        $arrReservedWords[] = 'dojebałam';
        $arrReservedWords[] = 'dojebalam';
        $arrReservedWords[] = 'dojebię';
        $arrReservedWords[] = 'dojebie';
        $arrReservedWords[] = 'dopieprzać';
        $arrReservedWords[] = 'dopieprzac';
        $arrReservedWords[] = 'dopierdalać';
        $arrReservedWords[] = 'dopierdalac';
        $arrReservedWords[] = 'dopierdala';
        $arrReservedWords[] = 'dopierdalał';
        $arrReservedWords[] = 'dopierdalal';
        $arrReservedWords[] = 'dopierdalała';
        $arrReservedWords[] = 'dopierdalala';
        $arrReservedWords[] = 'dopierdoli';
        $arrReservedWords[] = 'dopierdolił';
        $arrReservedWords[] = 'dopierdolil';
        $arrReservedWords[] = 'dopierdolę';
        $arrReservedWords[] = 'dopierdole';
        $arrReservedWords[] = 'dopierdoli';
        $arrReservedWords[] = 'dopierdalający';
        $arrReservedWords[] = 'dopierdalajacy';
        $arrReservedWords[] = 'dopierdolić';
        $arrReservedWords[] = 'dopierdolic';
        $arrReservedWords[] = 'dupa';
        $arrReservedWords[] = 'dupie';
        $arrReservedWords[] = 'dupą';
        $arrReservedWords[] = 'dupcia';
        $arrReservedWords[] = 'dupeczka';
        $arrReservedWords[] = 'dupy';
        $arrReservedWords[] = 'dupe';
        $arrReservedWords[] = 'huj';
        $arrReservedWords[] = 'hujek';
        $arrReservedWords[] = 'hujnia';
        $arrReservedWords[] = 'huja';
        $arrReservedWords[] = 'huje';
        $arrReservedWords[] = 'hujem';
        $arrReservedWords[] = 'huju';
        $arrReservedWords[] = 'jebać';
        $arrReservedWords[] = 'jebac';
        $arrReservedWords[] = 'jebał';
        $arrReservedWords[] = 'jebal';
        $arrReservedWords[] = 'jebie';
        $arrReservedWords[] = 'jebią';
        $arrReservedWords[] = 'jebia';
        $arrReservedWords[] = 'jebak';
        $arrReservedWords[] = 'jebaka';
        $arrReservedWords[] = 'jebal';
        $arrReservedWords[] = 'jebał';
        $arrReservedWords[] = 'jebany';
        $arrReservedWords[] = 'jebane';
        $arrReservedWords[] = 'jebanka';
        $arrReservedWords[] = 'jebanko';
        $arrReservedWords[] = 'jebankiem';
        $arrReservedWords[] = 'jebanymi';
        $arrReservedWords[] = 'jebana';
        $arrReservedWords[] = 'jebanym';
        $arrReservedWords[] = 'jebanej';
        $arrReservedWords[] = 'jebaną';
        $arrReservedWords[] = 'jebana';
        $arrReservedWords[] = 'jebani';
        $arrReservedWords[] = 'jebanych';
        $arrReservedWords[] = 'jebanymi';
        $arrReservedWords[] = 'jebcie';
        $arrReservedWords[] = 'jebiący';
        $arrReservedWords[] = 'jebiacy';
        $arrReservedWords[] = 'jebiąca';
        $arrReservedWords[] = 'jebiaca';
        $arrReservedWords[] = 'jebiącego';
        $arrReservedWords[] = 'jebiacego';
        $arrReservedWords[] = 'jebiącej';
        $arrReservedWords[] = 'jebiacej';
        $arrReservedWords[] = 'jebia';
        $arrReservedWords[] = 'jebią';
        $arrReservedWords[] = 'jebie';
        $arrReservedWords[] = 'jebię';
        $arrReservedWords[] = 'jebliwy';
        $arrReservedWords[] = 'jebnąć';
        $arrReservedWords[] = 'jebnac';
        $arrReservedWords[] = 'jebnąc';
        $arrReservedWords[] = 'jebnać';
        $arrReservedWords[] = 'jebnął';
        $arrReservedWords[] = 'jebnal';
        $arrReservedWords[] = 'jebną';
        $arrReservedWords[] = 'jebna';
        $arrReservedWords[] = 'jebnęła';
        $arrReservedWords[] = 'jebnela';
        $arrReservedWords[] = 'jebnie';
        $arrReservedWords[] = 'jebnij';
        $arrReservedWords[] = 'jebut';
        $arrReservedWords[] = 'koorwa';
        $arrReservedWords[] = 'kórwa';
        $arrReservedWords[] = 'kurestwo';
        $arrReservedWords[] = 'kurew';
        $arrReservedWords[] = 'kurewski';
        $arrReservedWords[] = 'kurewska';
        $arrReservedWords[] = 'kurewskiej';
        $arrReservedWords[] = 'kurewską';
        $arrReservedWords[] = 'kurewska';
        $arrReservedWords[] = 'kurewsko';
        $arrReservedWords[] = 'kurewstwo';
        $arrReservedWords[] = 'kurwa';
        $arrReservedWords[] = 'kurwaa';
        $arrReservedWords[] = 'kurwami';
        $arrReservedWords[] = 'kurwą';
        $arrReservedWords[] = 'kurwe';
        $arrReservedWords[] = 'kurwę';
        $arrReservedWords[] = 'kurwie';
        $arrReservedWords[] = 'kurwiska';
        $arrReservedWords[] = 'kurwo';
        $arrReservedWords[] = 'kurwy';
        $arrReservedWords[] = 'kurwach';
        $arrReservedWords[] = 'kurwami';
        $arrReservedWords[] = 'kurewski';
        $arrReservedWords[] = 'kurwiarz';
        $arrReservedWords[] = 'kurwiący';
        $arrReservedWords[] = 'kurwica';
        $arrReservedWords[] = 'kurwić';
        $arrReservedWords[] = 'kurwic';
        $arrReservedWords[] = 'kurwidołek';
        $arrReservedWords[] = 'kurwik';
        $arrReservedWords[] = 'kurwiki';
        $arrReservedWords[] = 'kurwiszcze';
        $arrReservedWords[] = 'kurwiszon';
        $arrReservedWords[] = 'kurwiszona';
        $arrReservedWords[] = 'kurwiszonem';
        $arrReservedWords[] = 'kurwiszony';
        $arrReservedWords[] = 'kutas';
        $arrReservedWords[] = 'kutasa';
        $arrReservedWords[] = 'kutasie';
        $arrReservedWords[] = 'kutasem';
        $arrReservedWords[] = 'kutasy';
        $arrReservedWords[] = 'kutasów';
        $arrReservedWords[] = 'kutasow';
        $arrReservedWords[] = 'kutasach';
        $arrReservedWords[] = 'kutasami';
        $arrReservedWords[] = 'matkojebca';
        $arrReservedWords[] = 'matkojebcy';
        $arrReservedWords[] = 'matkojebcą';
        $arrReservedWords[] = 'matkojebca';
        $arrReservedWords[] = 'matkojebcami';
        $arrReservedWords[] = 'matkojebcach';
        $arrReservedWords[] = 'nabarłożyć';
        $arrReservedWords[] = 'najebać';
        $arrReservedWords[] = 'najebac';
        $arrReservedWords[] = 'najebał';
        $arrReservedWords[] = 'najebal';
        $arrReservedWords[] = 'najebała';
        $arrReservedWords[] = 'najebala';
        $arrReservedWords[] = 'najebane';
        $arrReservedWords[] = 'najebany';
        $arrReservedWords[] = 'najebaną';
        $arrReservedWords[] = 'najebana';
        $arrReservedWords[] = 'najebie';
        $arrReservedWords[] = 'najebią';
        $arrReservedWords[] = 'najebia';
        $arrReservedWords[] = 'naopierdalać';
        $arrReservedWords[] = 'naopierdalac';
        $arrReservedWords[] = 'naopierdalał';
        $arrReservedWords[] = 'naopierdalal';
        $arrReservedWords[] = 'naopierdalała';
        $arrReservedWords[] = 'naopierdalala';
        $arrReservedWords[] = 'naopierdalała';
        $arrReservedWords[] = 'napierdalać';
        $arrReservedWords[] = 'napierdalac';
        $arrReservedWords[] = 'napierdalający';
        $arrReservedWords[] = 'napierdalajacy';
        $arrReservedWords[] = 'napierdolić';
        $arrReservedWords[] = 'napierdolic';
        $arrReservedWords[] = 'nawpierdalać';
        $arrReservedWords[] = 'nawpierdalac';
        $arrReservedWords[] = 'nawpierdalał';
        $arrReservedWords[] = 'nawpierdalal';
        $arrReservedWords[] = 'nawpierdalała';
        $arrReservedWords[] = 'nawpierdalala';
        $arrReservedWords[] = 'obsrywać';
        $arrReservedWords[] = 'obsrywac';
        $arrReservedWords[] = 'obsrywający';
        $arrReservedWords[] = 'obsrywajacy';
        $arrReservedWords[] = 'odpieprzać';
        $arrReservedWords[] = 'odpieprzac';
        $arrReservedWords[] = 'odpieprzy';
        $arrReservedWords[] = 'odpieprzył';
        $arrReservedWords[] = 'odpieprzyl';
        $arrReservedWords[] = 'odpieprzyła';
        $arrReservedWords[] = 'odpieprzyla';
        $arrReservedWords[] = 'odpierdalać';
        $arrReservedWords[] = 'odpierdalac';
        $arrReservedWords[] = 'odpierdol';
        $arrReservedWords[] = 'odpierdolił';
        $arrReservedWords[] = 'odpierdolil';
        $arrReservedWords[] = 'odpierdoliła';
        $arrReservedWords[] = 'odpierdolila';
        $arrReservedWords[] = 'odpierdoli';
        $arrReservedWords[] = 'odpierdalający';
        $arrReservedWords[] = 'odpierdalajacy';
        $arrReservedWords[] = 'odpierdalająca';
        $arrReservedWords[] = 'odpierdalajaca';
        $arrReservedWords[] = 'odpierdolić';
        $arrReservedWords[] = 'odpierdolic';
        $arrReservedWords[] = 'odpierdoli';
        $arrReservedWords[] = 'odpierdolił';
        $arrReservedWords[] = 'opieprzający';
        $arrReservedWords[] = 'opierdalać';
        $arrReservedWords[] = 'opierdalac';
        $arrReservedWords[] = 'opierdala';
        $arrReservedWords[] = 'opierdalający';
        $arrReservedWords[] = 'opierdalajacy';
        $arrReservedWords[] = 'opierdol';
        $arrReservedWords[] = 'opierdolić';
        $arrReservedWords[] = 'opierdolic';
        $arrReservedWords[] = 'opierdoli';
        $arrReservedWords[] = 'opierdolą';
        $arrReservedWords[] = 'opierdola';
        $arrReservedWords[] = 'piczka';
        $arrReservedWords[] = 'pieprznięty';
        $arrReservedWords[] = 'pieprzniety';
        $arrReservedWords[] = 'pieprzony';
        $arrReservedWords[] = 'pierdel';
        $arrReservedWords[] = 'pierdlu';
        $arrReservedWords[] = 'pierdolą';
        $arrReservedWords[] = 'pierdola';
        $arrReservedWords[] = 'pierdolący';
        $arrReservedWords[] = 'pierdolacy';
        $arrReservedWords[] = 'pierdoląca';
        $arrReservedWords[] = 'pierdolaca';
        $arrReservedWords[] = 'pierdol';
        $arrReservedWords[] = 'pierdole';
        $arrReservedWords[] = 'pierdolenie';
        $arrReservedWords[] = 'pierdoleniem';
        $arrReservedWords[] = 'pierdoleniu';
        $arrReservedWords[] = 'pierdolę';
        $arrReservedWords[] = 'pierdolec';
        $arrReservedWords[] = 'pierdola';
        $arrReservedWords[] = 'pierdolą';
        $arrReservedWords[] = 'pierdolić';
        $arrReservedWords[] = 'pierdolicie';
        $arrReservedWords[] = 'pierdolic';
        $arrReservedWords[] = 'pierdolił';
        $arrReservedWords[] = 'pierdolil';
        $arrReservedWords[] = 'pierdoliła';
        $arrReservedWords[] = 'pierdolila';
        $arrReservedWords[] = 'pierdoli';
        $arrReservedWords[] = 'pierdolnięty';
        $arrReservedWords[] = 'pierdolniety';
        $arrReservedWords[] = 'pierdolisz';
        $arrReservedWords[] = 'pierdolnąć';
        $arrReservedWords[] = 'pierdolnac';
        $arrReservedWords[] = 'pierdolnął';
        $arrReservedWords[] = 'pierdolnal';
        $arrReservedWords[] = 'pierdolnęła';
        $arrReservedWords[] = 'pierdolnela';
        $arrReservedWords[] = 'pierdolnie';
        $arrReservedWords[] = 'pierdolnięty';
        $arrReservedWords[] = 'pierdolnij';
        $arrReservedWords[] = 'pierdolnik';
        $arrReservedWords[] = 'pierdolona';
        $arrReservedWords[] = 'pierdolone';
        $arrReservedWords[] = 'pierdolony';
        $arrReservedWords[] = 'pierdołki';
        $arrReservedWords[] = 'pierdzący';
        $arrReservedWords[] = 'pierdzieć';
        $arrReservedWords[] = 'pierdziec';
        $arrReservedWords[] = 'pizda';
        $arrReservedWords[] = 'pizdą';
        $arrReservedWords[] = 'pizde';
        $arrReservedWords[] = 'pizdę';
        $arrReservedWords[] = 'pidzie';
        $arrReservedWords[] = 'pizdzie';
        $arrReservedWords[] = 'pizdnąć';
        $arrReservedWords[] = 'pizdnac';
        $arrReservedWords[] = 'pizdu';
        $arrReservedWords[] = 'podpierdalać';
        $arrReservedWords[] = 'podpierdalac';
        $arrReservedWords[] = 'podpierdala';
        $arrReservedWords[] = 'podpierdalający';
        $arrReservedWords[] = 'podpierdalajacy';
        $arrReservedWords[] = 'podpierdolić';
        $arrReservedWords[] = 'podpierdolic';
        $arrReservedWords[] = 'podpierdoli';
        $arrReservedWords[] = 'pojeb';
        $arrReservedWords[] = 'pojeba';
        $arrReservedWords[] = 'pojebami';
        $arrReservedWords[] = 'pojebani';
        $arrReservedWords[] = 'pojebanego';
        $arrReservedWords[] = 'pojebanemu';
        $arrReservedWords[] = 'pojebani';
        $arrReservedWords[] = 'pojebany';
        $arrReservedWords[] = 'pojebanych';
        $arrReservedWords[] = 'pojebanym';
        $arrReservedWords[] = 'pojebanymi';
        $arrReservedWords[] = 'pojebem';
        $arrReservedWords[] = 'pojebać';
        $arrReservedWords[] = 'pojebac';
        $arrReservedWords[] = 'pojebalo';
        $arrReservedWords[] = 'popierdala';
        $arrReservedWords[] = 'popierdalac';
        $arrReservedWords[] = 'popierdalać';
        $arrReservedWords[] = 'popierdolić';
        $arrReservedWords[] = 'popierdolic';
        $arrReservedWords[] = 'popierdoli';
        $arrReservedWords[] = 'popierdolonego';
        $arrReservedWords[] = 'popierdolonemu';
        $arrReservedWords[] = 'popierdolonym';
        $arrReservedWords[] = 'popierdolone';
        $arrReservedWords[] = 'popierdoleni';
        $arrReservedWords[] = 'popierdolony';
        $arrReservedWords[] = 'porozpierdalać';
        $arrReservedWords[] = 'porozpierdala';
        $arrReservedWords[] = 'porozpierdalac';
        $arrReservedWords[] = 'poruchac';
        $arrReservedWords[] = 'poruchać';
        $arrReservedWords[] = 'przejebać';
        $arrReservedWords[] = 'przejebane';
        $arrReservedWords[] = 'przejebac';
        $arrReservedWords[] = 'przyjebali';
        $arrReservedWords[] = 'przepierdalać';
        $arrReservedWords[] = 'przepierdalac';
        $arrReservedWords[] = 'przepierdala';
        $arrReservedWords[] = 'przepierdalający';
        $arrReservedWords[] = 'przepierdalajacy';
        $arrReservedWords[] = 'przepierdalająca';
        $arrReservedWords[] = 'przepierdalajaca';
        $arrReservedWords[] = 'przepierdolić';
        $arrReservedWords[] = 'przepierdolic';
        $arrReservedWords[] = 'przyjebać';
        $arrReservedWords[] = 'przyjebac';
        $arrReservedWords[] = 'przyjebie';
        $arrReservedWords[] = 'przyjebała';
        $arrReservedWords[] = 'przyjebala';
        $arrReservedWords[] = 'przyjebał';
        $arrReservedWords[] = 'przyjebal';
        $arrReservedWords[] = 'przypieprzać';
        $arrReservedWords[] = 'przypieprzac';
        $arrReservedWords[] = 'przypieprzający';
        $arrReservedWords[] = 'przypieprzajacy';
        $arrReservedWords[] = 'przypieprzająca';
        $arrReservedWords[] = 'przypieprzajaca';
        $arrReservedWords[] = 'przypierdalać';
        $arrReservedWords[] = 'przypierdalac';
        $arrReservedWords[] = 'przypierdala';
        $arrReservedWords[] = 'przypierdoli';
        $arrReservedWords[] = 'przypierdalający';
        $arrReservedWords[] = 'przypierdalajacy';
        $arrReservedWords[] = 'przypierdolić';
        $arrReservedWords[] = 'przypierdolic';
        $arrReservedWords[] = 'qrwa';
        $arrReservedWords[] = 'rozjebać';
        $arrReservedWords[] = 'rozjebac';
        $arrReservedWords[] = 'rozjebie';
        $arrReservedWords[] = 'rozjebała';
        $arrReservedWords[] = 'rozjebią';
        $arrReservedWords[] = 'rozpierdalać';
        $arrReservedWords[] = 'rozpierdalac';
        $arrReservedWords[] = 'rozpierdala';
        $arrReservedWords[] = 'rozpierdolić';
        $arrReservedWords[] = 'rozpierdolic';
        $arrReservedWords[] = 'rozpierdole';
        $arrReservedWords[] = 'rozpierdoli';
        $arrReservedWords[] = 'rozpierducha';
        $arrReservedWords[] = 'skurwić';
        $arrReservedWords[] = 'skurwiel';
        $arrReservedWords[] = 'skurwiela';
        $arrReservedWords[] = 'skurwielem';
        $arrReservedWords[] = 'skurwielu';
        $arrReservedWords[] = 'skurwysyn';
        $arrReservedWords[] = 'skurwysynów';
        $arrReservedWords[] = 'skurwysynow';
        $arrReservedWords[] = 'skurwysyna';
        $arrReservedWords[] = 'skurwysynem';
        $arrReservedWords[] = 'skurwysynu';
        $arrReservedWords[] = 'skurwysyny';
        $arrReservedWords[] = 'skurwysyński';
        $arrReservedWords[] = 'skurwysynski';
        $arrReservedWords[] = 'skurwysyństwo';
        $arrReservedWords[] = 'skurwysynstwo';
        $arrReservedWords[] = 'spieprzać';
        $arrReservedWords[] = 'spieprzac';
        $arrReservedWords[] = 'spieprza';
        $arrReservedWords[] = 'spieprzaj';
        $arrReservedWords[] = 'spieprzajcie';
        $arrReservedWords[] = 'spieprzają';
        $arrReservedWords[] = 'spieprzaja';
        $arrReservedWords[] = 'spieprzający';
        $arrReservedWords[] = 'spieprzajacy';
        $arrReservedWords[] = 'spieprzająca';
        $arrReservedWords[] = 'spieprzajaca';
        $arrReservedWords[] = 'spierdalać';
        $arrReservedWords[] = 'spierdalac';
        $arrReservedWords[] = 'spierdala';
        $arrReservedWords[] = 'spierdalał';
        $arrReservedWords[] = 'spierdalała';
        $arrReservedWords[] = 'spierdalal';
        $arrReservedWords[] = 'spierdalalcie';
        $arrReservedWords[] = 'spierdalala';
        $arrReservedWords[] = 'spierdalający';
        $arrReservedWords[] = 'spierdalajacy';
        $arrReservedWords[] = 'spierdolić';
        $arrReservedWords[] = 'spierdolic';
        $arrReservedWords[] = 'spierdoli';
        $arrReservedWords[] = 'spierdoliła';
        $arrReservedWords[] = 'spierdoliło';
        $arrReservedWords[] = 'spierdolą';
        $arrReservedWords[] = 'spierdola';
        $arrReservedWords[] = 'srać';
        $arrReservedWords[] = 'srac';
        $arrReservedWords[] = 'srający';
        $arrReservedWords[] = 'srajacy';
        $arrReservedWords[] = 'srając';
        $arrReservedWords[] = 'srajac';
        $arrReservedWords[] = 'sraj';
        $arrReservedWords[] = 'sukinsyn';
        $arrReservedWords[] = 'sukinsyny';
        $arrReservedWords[] = 'sukinsynom';
        $arrReservedWords[] = 'sukinsynowi';
        $arrReservedWords[] = 'sukinsynów';
        $arrReservedWords[] = 'sukinsynow';
        $arrReservedWords[] = 'mierdziel';
        $arrReservedWords[] = 'udupić';
        $arrReservedWords[] = 'ujebać';
        $arrReservedWords[] = 'ujebac';
        $arrReservedWords[] = 'ujebał';
        $arrReservedWords[] = 'ujebal';
        $arrReservedWords[] = 'ujebana';
        $arrReservedWords[] = 'ujebany';
        $arrReservedWords[] = 'ujebie';
        $arrReservedWords[] = 'ujebała';
        $arrReservedWords[] = 'ujebala';
        $arrReservedWords[] = 'upierdalać';
        $arrReservedWords[] = 'upierdalac';
        $arrReservedWords[] = 'upierdala';
        $arrReservedWords[] = 'upierdoli';
        $arrReservedWords[] = 'upierdolić';
        $arrReservedWords[] = 'upierdolic';
        $arrReservedWords[] = 'upierdoli';
        $arrReservedWords[] = 'upierdolą';
        $arrReservedWords[] = 'upierdola';
        $arrReservedWords[] = 'upierdoleni';
        $arrReservedWords[] = 'wjebać';
        $arrReservedWords[] = 'wjebac';
        $arrReservedWords[] = 'wjebie';
        $arrReservedWords[] = 'wjebią';
        $arrReservedWords[] = 'wjebia';
        $arrReservedWords[] = 'wjebiemy';
        $arrReservedWords[] = 'wjebiecie';
        $arrReservedWords[] = 'wkurwiać';
        $arrReservedWords[] = 'wkurwiac';
        $arrReservedWords[] = 'wkurwi';
        $arrReservedWords[] = 'wkurwia';
        $arrReservedWords[] = 'wkurwiał';
        $arrReservedWords[] = 'wkurwial';
        $arrReservedWords[] = 'wkurwiający';
        $arrReservedWords[] = 'wkurwiajacy';
        $arrReservedWords[] = 'wkurwiająca';
        $arrReservedWords[] = 'wkurwiajaca';
        $arrReservedWords[] = 'wkurwić';
        $arrReservedWords[] = 'wkurwic';
        $arrReservedWords[] = 'wkurwi';
        $arrReservedWords[] = 'wkurwiacie';
        $arrReservedWords[] = 'wkurwiają';
        $arrReservedWords[] = 'wkurwiali';
        $arrReservedWords[] = 'wkurwią';
        $arrReservedWords[] = 'wkurwia';
        $arrReservedWords[] = 'wkurwimy';
        $arrReservedWords[] = 'wkurwicie';
        $arrReservedWords[] = 'wkurwiacie';
        $arrReservedWords[] = 'wkurwić';
        $arrReservedWords[] = 'wkurwic';
        $arrReservedWords[] = 'wkurwia';
        $arrReservedWords[] = 'wpierdalać';
        $arrReservedWords[] = 'wpierdalac';
        $arrReservedWords[] = 'wpierdalający';
        $arrReservedWords[] = 'wpierdalajacy';
        $arrReservedWords[] = 'wpierdol';
        $arrReservedWords[] = 'wpierdolić';
        $arrReservedWords[] = 'wpierdolic';
        $arrReservedWords[] = 'wpizdu';
        $arrReservedWords[] = 'wyjebać';
        $arrReservedWords[] = 'wyjebac';
        $arrReservedWords[] = 'wyjebali';
        $arrReservedWords[] = 'wyjebał';
        $arrReservedWords[] = 'wyjebac';
        $arrReservedWords[] = 'wyjebała';
        $arrReservedWords[] = 'wyjebały';
        $arrReservedWords[] = 'wyjebie';
        $arrReservedWords[] = 'wyjebią';
        $arrReservedWords[] = 'wyjebia';
        $arrReservedWords[] = 'wyjebiesz';
        $arrReservedWords[] = 'wyjebie';
        $arrReservedWords[] = 'wyjebiecie';
        $arrReservedWords[] = 'wyjebiemy';
        $arrReservedWords[] = 'wypieprzać';
        $arrReservedWords[] = 'wypieprzac';
        $arrReservedWords[] = 'wypieprza';
        $arrReservedWords[] = 'wypieprzał';
        $arrReservedWords[] = 'wypieprzal';
        $arrReservedWords[] = 'wypieprzała';
        $arrReservedWords[] = 'wypieprzala';
        $arrReservedWords[] = 'wypieprzy';
        $arrReservedWords[] = 'wypieprzyła';
        $arrReservedWords[] = 'wypieprzyla';
        $arrReservedWords[] = 'wypieprzył';
        $arrReservedWords[] = 'wypieprzyl';
        $arrReservedWords[] = 'wypierdal';
        $arrReservedWords[] = 'wypierdalać';
        $arrReservedWords[] = 'wypierdalac';
        $arrReservedWords[] = 'wypierdala';
        $arrReservedWords[] = 'wypierdalaj';
        $arrReservedWords[] = 'wypierdalał';
        $arrReservedWords[] = 'wypierdalal';
        $arrReservedWords[] = 'wypierdalała';
        $arrReservedWords[] = 'wypierdalala';
        $arrReservedWords[] = 'wypierdalać';
        $arrReservedWords[] = 'wypierdolić';
        $arrReservedWords[] = 'wypierdolic';
        $arrReservedWords[] = 'wypierdoli';
        $arrReservedWords[] = 'wypierdolimy';
        $arrReservedWords[] = 'wypierdolicie';
        $arrReservedWords[] = 'wypierdolą';
        $arrReservedWords[] = 'wypierdola';
        $arrReservedWords[] = 'wypierdolili';
        $arrReservedWords[] = 'wypierdolił';
        $arrReservedWords[] = 'wypierdolil';
        $arrReservedWords[] = 'wypierdoliła';
        $arrReservedWords[] = 'wypierdolila';
        $arrReservedWords[] = 'zajebać';
        $arrReservedWords[] = 'zajebac';
        $arrReservedWords[] = 'zajebie';
        $arrReservedWords[] = 'zajebią';
        $arrReservedWords[] = 'zajebia';
        $arrReservedWords[] = 'zajebiał';
        $arrReservedWords[] = 'zajebial';
        $arrReservedWords[] = 'zajebała';
        $arrReservedWords[] = 'zajebiala';
        $arrReservedWords[] = 'zajebali';
        $arrReservedWords[] = 'zajebana';
        $arrReservedWords[] = 'zajebani';
        $arrReservedWords[] = 'zajebane';
        $arrReservedWords[] = 'zajebany';
        $arrReservedWords[] = 'zajebanych';
        $arrReservedWords[] = 'zajebanym';
        $arrReservedWords[] = 'zajebanymi';
        $arrReservedWords[] = 'zajebiste';
        $arrReservedWords[] = 'zajebisty';
        $arrReservedWords[] = 'zajebistych';
        $arrReservedWords[] = 'zajebista';
        $arrReservedWords[] = 'zajebistym';
        $arrReservedWords[] = 'zajebistymi';
        $arrReservedWords[] = 'zajebicie';
        $arrReservedWords[] = 'zajebiscie';
        $arrReservedWords[] = 'zapieprzyć';
        $arrReservedWords[] = 'zapieprzyc';
        $arrReservedWords[] = 'zapieprzy';
        $arrReservedWords[] = 'zapieprzył';
        $arrReservedWords[] = 'zapieprzyl';
        $arrReservedWords[] = 'zapieprzyła';
        $arrReservedWords[] = 'zapieprzyla';
        $arrReservedWords[] = 'zapieprzą';
        $arrReservedWords[] = 'zapieprza';
        $arrReservedWords[] = 'zapieprzy';
        $arrReservedWords[] = 'zapieprzymy';
        $arrReservedWords[] = 'zapieprzycie';
        $arrReservedWords[] = 'zapieprzysz';
        $arrReservedWords[] = 'zapierdala';
        $arrReservedWords[] = 'zapierdalać';
        $arrReservedWords[] = 'zapierdalac';
        $arrReservedWords[] = 'zapierdalaja';
        $arrReservedWords[] = 'zapierdalał';
        $arrReservedWords[] = 'zapierdalaj';
        $arrReservedWords[] = 'zapierdalajcie';
        $arrReservedWords[] = 'zapierdalała';
        $arrReservedWords[] = 'zapierdalala';
        $arrReservedWords[] = 'zapierdalali';
        $arrReservedWords[] = 'zapierdalający';
        $arrReservedWords[] = 'zapierdalajacy';
        $arrReservedWords[] = 'zapierdolić';
        $arrReservedWords[] = 'zapierdolic';
        $arrReservedWords[] = 'zapierdoli';
        $arrReservedWords[] = 'zapierdolił';
        $arrReservedWords[] = 'zapierdolil';
        $arrReservedWords[] = 'zapierdoliła';
        $arrReservedWords[] = 'zapierdolila';
        $arrReservedWords[] = 'zapierdolą';
        $arrReservedWords[] = 'zapierdola';
        $arrReservedWords[] = 'zapierniczać';
        $arrReservedWords[] = 'zapierniczający';
        $arrReservedWords[] = 'zasrać';
        $arrReservedWords[] = 'zasranym';
        $arrReservedWords[] = 'zasrywać';
        $arrReservedWords[] = 'zasrywający';
        $arrReservedWords[] = 'zesrywać';
        $arrReservedWords[] = 'zesrywający';
        $arrReservedWords[] = 'zjebać';
        $arrReservedWords[] = 'zjebac';
        $arrReservedWords[] = 'zjebał';
        $arrReservedWords[] = 'zjebal';
        $arrReservedWords[] = 'zjebała';
        $arrReservedWords[] = 'zjebala';
        $arrReservedWords[] = 'zjebana';
        $arrReservedWords[] = 'zjebią';
        $arrReservedWords[] = 'zjebali';
        $arrReservedWords[] = 'zjeby';
        
        DbFactory::setDefaultConnection($strConnectionName);
        $objDb = DbFactory::getInstance();
$strQPattern = <<<EOF
UPDATE offer 
SET adults_only_suspicion = 1 
WHERE title_pl ILIKE '%%%s%%' OR description ILIKE '%%%s%%'
EOF;
        
        $numIndex = 1;
        $numCount = count($arrReservedWords);
        foreach ($arrReservedWords as $strWord) {
            $strQ = sprintf($strQPattern, $strWord, $strWord);
            $objSth = $objDb->prepare($strQ);
            $objSth->execute();
            echo sprintf('%d/%d done', $numIndex, $numCount).PHP_EOL;
            $numIndex++;
//            $a = $objSth->fetch();
//            echo '<Pre>';
//            print_r($a);echo '</pre>';
//            echo $strWord.': '.$a['cnt'].PHP_EOL;
        }
        unset($objDb);
//        
//        $strQ = "SELECT * FROM offer WHERE ";
//        foreach ($arrReservedWords as $strWord) {
//            $strQ .= "title_pl ILIKE '%".$strWord."%' OR ";
//        }
//        $strQ = trim($strQ, ' OR ');
//        echo $strQ;
    }
    
    public function buildStats () {
        $objArtifactModel = new ArtifactModel();
        $objArtifactModel->refreshStats();
    }
    
}